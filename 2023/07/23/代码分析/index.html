<!DOCTYPE html>


<html lang="en">
  

    <head>
      <meta charset="utf-8" />
        
      <meta name="description" content="一个简单的博客" />
      
      <meta
        name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1"
      />
      <title> 王晋</title>
  <meta name="generator" content="hexo-theme-ayer">
      
      <link rel="shortcut icon" href="/favicon.ico" />
       
<link rel="stylesheet" href="/dist/main.css">

      
<link rel="stylesheet" href="/css/fonts/remixicon.css">

      
<link rel="stylesheet" href="/css/custom.css">
 
      <script src="https://cdn.staticfile.org/pace/1.2.4/pace.min.js"></script>
       
 

      <link
        rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/@sweetalert2/theme-bulma@5.0.1/bulma.min.css"
      />
      <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.19/dist/sweetalert2.min.js"></script>

      <!-- mermaid -->
      
      <style>
        .swal2-styled.swal2-confirm {
          font-size: 1.6rem;
        }
      </style>
    </head>
  </html>
</html>


<body>
  <div id="app">
    
      
    <main class="content on">
      <section class="outer">
  <article
  id="post-代码分析"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
     
    <div class="article-meta">
      <a href="/2023/07/23/%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90/" class="article-date">
  <time datetime="2023-07-23T09:41:18.534Z" itemprop="datePublished">2023-07-23</time>
</a>   
<div class="word_count">
    <span class="post-time">
        <span class="post-meta-item-icon">
            <i class="ri-quill-pen-line"></i>
            <span class="post-meta-item-text"> Word count:</span>
            <span class="post-count">9.2k</span>
        </span>
    </span>

    <span class="post-time">
        &nbsp; | &nbsp;
        <span class="post-meta-item-icon">
            <i class="ri-book-open-line"></i>
            <span class="post-meta-item-text"> Reading time≈</span>
            <span class="post-count">45 min</span>
        </span>
    </span>
</div>
 
    </div>
      
    <div class="tocbot"></div>




  
    <div class="article-entry" itemprop="articleBody">
       
  <p>目录</p>
<h3 id="BASE"><a href="#BASE" class="headerlink" title="BASE"></a>BASE</h3><h4 id="zzdog-java-服务器"><a href="#zzdog-java-服务器" class="headerlink" title="zzdog.java(服务器)"></a>zzdog.java(服务器)</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.net.ServerSocket;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.ConcurrentHashMap;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ZZDog</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="comment">//System.out.println(&quot;123&quot;);</span></span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">ZZDog</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//用于侦听特定端口上的传入客户端连接。</span></span><br><span class="line">    ServerSocket server;</span><br><span class="line">    <span class="comment">//它将使用整数ID作为键和客户端对象作为值来存储连接的客户端。类用于允许从不同线程并发访问客户端集合，而不会导致数据损坏或不一致。</span></span><br><span class="line">    ConcurrentHashMap&lt;Integer,Client&gt; clients = <span class="keyword">new</span> <span class="title class_">ConcurrentHashMap</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span> <span class="variable">id</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ZZDog</span><span class="params">()</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="comment">//创建一个新对象并将其绑定到端口</span></span><br><span class="line">        server = <span class="keyword">new</span> <span class="title class_">ServerSocket</span>(<span class="number">8084</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;start&quot;</span>);</span><br><span class="line">        <span class="keyword">while</span>(<span class="literal">true</span>)&#123;</span><br><span class="line">            <span class="type">Socket</span> <span class="variable">socket</span> <span class="operator">=</span> server.accept();</span><br><span class="line">            System.out.println(socket);</span><br><span class="line">            <span class="type">Client</span> <span class="variable">client</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Client</span>(socket);</span><br><span class="line">            client.start();</span><br><span class="line">            clients.put(id++,client);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">该类为服务器提供了一种侦听传入客户端连接的机制。当客户端连接到服务器时，服务器会创建一个新对象来表示客户端的连接结束</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">服务器使用 ServerSocket 的 accept（） 方法侦听传入的客户端连接，该方法在客户端连接之前一直阻塞。客户端连接后，服务器将创建一个新的 Socket 对象来处理客户端连接，然后创建一个新的 Client 对象来表示连接的客户端。</span><br><span class="line"></span><br><span class="line">客户端对象将新的 Socket 对象作为参数传递，然后调用其 start（） 方法。start（） 方法开始执行客户端线程的 run（） 方法，该方法处理向客户端读取和从客户端写入数据。</span><br><span class="line"></span><br><span class="line">创建新的客户端对象后，服务器使用唯一的整数 id 作为键将其添加到 ConcurrentHashMap “client” 中。这允许服务器同时跟踪多个客户端。添加每个客户端后，ID 将递增，以确保每个客户端都具有唯一的 ID。</span><br><span class="line"></span><br><span class="line">while 循环继续使用阻塞 accept（） 方法无限期地侦听传入的客户端连接。</span><br></pre></td></tr></table></figure>

<h4 id="client-java（客户端）"><a href="#client-java（客户端）" class="headerlink" title="client.java（客户端）"></a>client.java（客户端）</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson2.JSON;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationTargetException;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Client</span> <span class="keyword">extends</span> <span class="title class_">Thread</span>&#123;</span><br><span class="line">    Socket socket;</span><br><span class="line">    BufferedReader br;</span><br><span class="line">    BufferedWriter bw;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Client</span><span class="params">(Socket socket)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.socket = socket;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            br = <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">InputStreamReader</span>(socket.getInputStream()));</span><br><span class="line">            bw = <span class="keyword">new</span> <span class="title class_">BufferedWriter</span>(<span class="keyword">new</span> <span class="title class_">OutputStreamWriter</span>(socket.getOutputStream()));</span><br><span class="line">            <span class="type">Request</span> <span class="variable">req</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Request</span>(br); <span class="comment">//客户端请求</span></span><br><span class="line"></span><br><span class="line">            <span class="type">Response</span> <span class="variable">res</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Response</span>(req,bw,socket); <span class="comment">//服务器响应</span></span><br><span class="line">            br.close();</span><br><span class="line">            bw.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InvocationTargetException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InstantiationException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IllegalAccessException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">此代码定义了一个扩展的类。该类负责处理来自已连接到服务器的单个客户端的请求</span><br><span class="line">socket：表示客户端连接端的对象Socket</span><br><span class="line">br：用于从客户端缓冲阅读器（clientBufferedReader）读取接收到的数据。</span><br><span class="line">bw：用于向clientBufferedWriter写出数据。</span><br><span class="line">该方法在线程启动时调用。它首先使用对象初始化和对象。然后，使用对象创建一个新对象，用于读取客户端的request.run()brbwsocketRequestbr</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Request req = new Request(br); //客户端请求</span><br><span class="line">这行代码使用提供的对象创建一个新对象。该类负责解析和存储客户端发送的 HTTP 请求消息中包含的信息。</span><br><span class="line">该对象创建后，可用于从请求中提取特定信息，如HTTP方法（如GET、POST）、URL路径（如/index.html）以及任何请求参数或头文件。</span><br><span class="line">服务器使用这些信息来决定如何处理客户端的请求并生成适当的响应。</span><br><span class="line"></span><br><span class="line">Response res = new Response(req,bw,socket); //服务器响应</span><br><span class="line">创建一个新对象。该类负责生成要发送回客户端的 HTTP 响应消息。</span><br><span class="line">该对象用于将响应消息写回客户端。该对象用于获取与套接字关联的输出流，该套接字用于将响应消息发送回客户端。</span><br></pre></td></tr></table></figure>

<h4 id="request-java"><a href="#request-java" class="headerlink" title="request.java"></a>request.java</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson2.JSON;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson2.JSONException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.net.URLDecoder;</span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Request</span> &#123;</span><br><span class="line">    BufferedReader br;</span><br><span class="line">    String method;</span><br><span class="line">    String url;</span><br><span class="line">    Map&lt;String,String&gt; headers = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    Map&lt;String,String&gt; params = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="type">Map</span> <span class="variable">json</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HashMap</span>();</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Request</span><span class="params">(BufferedReader br)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="built_in">this</span>.br = br;</span><br><span class="line">        String s;</span><br><span class="line">        <span class="keyword">while</span>((s=br.readLine())!=<span class="literal">null</span>)&#123;</span><br><span class="line">           <span class="comment">// System.out.println(s);</span></span><br><span class="line">            <span class="keyword">if</span>(s.getBytes().length==<span class="number">0</span>) &#123;</span><br><span class="line">               <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(s.endsWith(<span class="string">&quot;HTTP/1.1&quot;</span>))&#123;</span><br><span class="line">                String[] strs = s.split(<span class="string">&quot; &quot;</span>);</span><br><span class="line">                method = strs[<span class="number">0</span>];</span><br><span class="line">                <span class="type">int</span> <span class="variable">qIndex</span> <span class="operator">=</span> strs[<span class="number">1</span>].indexOf(<span class="string">&quot;?&quot;</span>);</span><br><span class="line">                <span class="keyword">if</span>(qIndex==-<span class="number">1</span>)&#123;</span><br><span class="line">                    url = strs[<span class="number">1</span>];</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    url = strs[<span class="number">1</span>].substring(<span class="number">0</span>,qIndex);</span><br><span class="line">                    String[] paramStrs =</span><br><span class="line">                            strs[<span class="number">1</span>].substring(qIndex+<span class="number">1</span>).split(<span class="string">&quot;&amp;&quot;</span>);</span><br><span class="line">                    <span class="keyword">for</span>(String ps:paramStrs)&#123;</span><br><span class="line">                        String[] kv = ps.split(<span class="string">&quot;=&quot;</span>);</span><br><span class="line">                        params.put(kv[<span class="number">0</span>], URLDecoder.decode(kv[<span class="number">1</span>]));</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                String[] ss = s.split(<span class="string">&quot;: &quot;</span>);</span><br><span class="line">                System.out.println(Arrays.toString(ss));</span><br><span class="line">                <span class="keyword">if</span>(ss.length==<span class="number">2</span>)</span><br><span class="line">                    headers.put(ss[<span class="number">0</span>],ss[<span class="number">1</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//System.out.println(method);</span></span><br><span class="line">        <span class="keyword">if</span>(method.equals(<span class="string">&quot;post&quot;</span>)||method.equals(<span class="string">&quot;POST&quot;</span>)) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">blen</span> <span class="operator">=</span> Integer.parseInt(headers.get(<span class="string">&quot;Content-Length&quot;</span>));</span><br><span class="line">            <span class="type">char</span>[] c = <span class="keyword">new</span> <span class="title class_">char</span>[blen];</span><br><span class="line">            <span class="type">int</span> len;</span><br><span class="line">            <span class="type">StringBuffer</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuffer</span>();</span><br><span class="line">            <span class="type">long</span> <span class="variable">readedlen</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span> ((len = br.read(c)) != -<span class="number">1</span>) &#123;</span><br><span class="line">                readedlen += (<span class="keyword">new</span> <span class="title class_">String</span>(c,<span class="number">0</span>,len)).getBytes().length;</span><br><span class="line">                sb.append(c, <span class="number">0</span>, len);</span><br><span class="line">                System.out.println(blen +<span class="string">&quot; &quot;</span>+readedlen);</span><br><span class="line">                <span class="keyword">if</span> (readedlen == blen) &#123;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//System.out.println(sb.toString());</span></span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                json = (Map) JSON.parse(sb.toString());</span><br><span class="line">            &#125;<span class="keyword">catch</span> (JSONException ex)&#123;</span><br><span class="line">                String[] strs = sb.toString().split(<span class="string">&quot;&amp;&quot;</span>);</span><br><span class="line">                <span class="keyword">for</span>(String str:strs)&#123;</span><br><span class="line">                    String[] ss = str.split(<span class="string">&quot;=&quot;</span>);</span><br><span class="line">                    <span class="keyword">if</span>(ss.length==<span class="number">2</span>)</span><br><span class="line">                        params.put(ss[<span class="number">0</span>],ss[<span class="number">1</span>]);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//System.out.println(json);</span></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="response-java"><a href="#response-java" class="headerlink" title="response.java"></a>response.java</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.BufferedWriter;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationTargetException;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Response</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        System.out.println(Math.random());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Response</span><span class="params">(Request req, BufferedWriter bw, Socket socket)</span> <span class="keyword">throws</span> IOException,</span><br><span class="line">            InstantiationException, IllegalAccessException, InvocationTargetException &#123;</span><br><span class="line"></span><br><span class="line">        String[] whites = <span class="keyword">new</span> <span class="title class_">String</span>[]&#123;<span class="string">&quot;/user_login&quot;</span>,<span class="string">&quot;/user_reg&quot;</span>,</span><br><span class="line">                <span class="string">&quot;/article_pay&quot;</span>,</span><br><span class="line">                <span class="string">&quot;/user_checkcode&quot;</span>,</span><br><span class="line">                <span class="string">&quot;/article_list&quot;</span>,</span><br><span class="line">                <span class="string">&quot;/user_sendmsg&quot;</span>,<span class="string">&quot;/catagory_topiclist&quot;</span>,<span class="string">&quot;/catagory_list&quot;</span>,&#125;;</span><br><span class="line">        <span class="type">String</span> <span class="variable">token</span> <span class="operator">=</span> req.headers.get(<span class="string">&quot;token&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//System.out.println(&quot;url:&quot;+req.url);</span></span><br><span class="line">        <span class="comment">//System.out.println(req.headers);</span></span><br><span class="line">        <span class="comment">//System.out.println(&quot;token:&quot;+token);</span></span><br><span class="line">        <span class="keyword">if</span>(!req.method.equals(<span class="string">&quot;OPTIONS&quot;</span>)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (token == <span class="literal">null</span> || token.length() &lt; <span class="number">20</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (!Arrays.asList(whites).contains(req.url)) &#123;</span><br><span class="line">                    <span class="type">String</span> <span class="variable">rs</span> <span class="operator">=</span> <span class="string">&quot;no login&quot;</span>;</span><br><span class="line">                    bw.write(<span class="string">&quot;HTTP/1.1 &quot;</span> + <span class="string">&quot;403&quot;</span> + <span class="string">&quot; OK\nAccess-Control-Allow-Headers: token\n&quot;</span> +</span><br><span class="line">                            <span class="string">&quot;Access-Control-Allow-Origin: *\n&quot;</span> +</span><br><span class="line">                            <span class="string">&quot;Content-Type: text/html;charset=utf-8\n&quot;</span> + <span class="string">&quot;Content-Length: &quot;</span> +</span><br><span class="line">                            rs.getBytes().length + <span class="string">&quot;\n\n&quot;</span> + rs);</span><br><span class="line">                    bw.flush();</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">rs</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">            bw.write(<span class="string">&quot;HTTP/1.1 &quot;</span> + <span class="string">&quot;200&quot;</span> + <span class="string">&quot; OK\nAccess-Control-Allow-Headers: token\n&quot;</span> +</span><br><span class="line">                    <span class="string">&quot;Access-Control-Allow-Origin: *\n&quot;</span> +</span><br><span class="line">                    <span class="string">&quot;Content-Type: text/html;charset=utf-8\n&quot;</span> + <span class="string">&quot;Content-Length: &quot;</span> +</span><br><span class="line">                    rs.getBytes().length + <span class="string">&quot;\n\n&quot;</span> + rs);</span><br><span class="line">            bw.flush();</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> <span class="variable">index</span> <span class="operator">=</span> req.url.indexOf(<span class="string">&quot;_&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">className</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">methodName</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span> (req.url.equals(<span class="string">&quot;/&quot;</span>)) &#123;</span><br><span class="line">            className = <span class="string">&quot;Index&quot;</span>;</span><br><span class="line">            methodName = <span class="string">&quot;index&quot;</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (index &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">                className = req.url.substring(<span class="number">1</span>, index);</span><br><span class="line">                className = className.substring(<span class="number">0</span>, <span class="number">1</span>).toUpperCase() +</span><br><span class="line">                        className.substring(<span class="number">1</span>);</span><br><span class="line">                methodName = req.url.substring(index + <span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        String rs;</span><br><span class="line">        <span class="type">String</span> <span class="variable">status</span> <span class="operator">=</span> <span class="string">&quot;200&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="type">Class</span> <span class="variable">clazz</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            clazz = Class.forName(<span class="string">&quot;org.example.&quot;</span> + className);</span><br><span class="line">            Method method;</span><br><span class="line">            <span class="comment">//System.out.println(methodName);</span></span><br><span class="line">            <span class="keyword">if</span>(methodName.equals(<span class="string">&quot;look&quot;</span>))&#123;</span><br><span class="line">                method = clazz.getMethod(methodName, Request.class,Socket.class);</span><br><span class="line">                method.invoke(clazz.newInstance(), req,socket);</span><br><span class="line">                rs = <span class="literal">null</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                method = clazz.getMethod(methodName, Request.class);</span><br><span class="line">                rs = (String) method.invoke(clazz.newInstance(), req);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">            status = <span class="string">&quot;404&quot;</span>;</span><br><span class="line">            rs = <span class="string">&quot;have no class&quot;</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (NoSuchMethodException e) &#123;</span><br><span class="line">            status = <span class="string">&quot;404&quot;</span>;</span><br><span class="line">            rs = <span class="string">&quot;have no method&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(rs==<span class="literal">null</span>) <span class="keyword">return</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">conentType</span> <span class="operator">=</span><span class="string">&quot;Content-Type: application/json;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;charset=utf-8\n&quot;</span>;</span><br><span class="line">        <span class="comment">// System.out.println(req.url);</span></span><br><span class="line">        <span class="keyword">if</span>(req.url.equals(<span class="string">&quot;/article_pay&quot;</span>))&#123;</span><br><span class="line">            conentType =<span class="string">&quot;Content-Type: text/html;&quot;</span> +</span><br><span class="line">                    <span class="string">&quot;charset=utf-8\n&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        bw.write(<span class="string">&quot;HTTP/1.1 &quot;</span> + status + <span class="string">&quot; OK\nAccess-Control-Allow-Headers: token\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;Access-Control-Allow-Origin: *\n&quot;</span> +</span><br><span class="line">                conentType + <span class="string">&quot;Content-Length: &quot;</span> +</span><br><span class="line">                rs.getBytes().length + <span class="string">&quot;\n\n&quot;</span> + rs);</span><br><span class="line">        bw.flush();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">text/html:将此网页看成一张图片</span><br><span class="line"></span><br><span class="line">响应头</span><br><span class="line">&quot;Content-Type: text/html;&quot; + &quot;charset=utf-8\n&quot;;</span><br><span class="line"></span><br><span class="line">支付时响应头变成网页</span><br><span class="line">if(req.url.equals(&quot;/article_pay&quot;))&#123;</span><br><span class="line">            conentType =&quot;Content-Type: text/html;&quot; +</span><br><span class="line">                    &quot;charset=utf-8\n&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/../t_%E4%BB%A3%E7%A0%81%E6%8A%A5%E9%94%99%E4%B8%8E%E5%88%86%E6%9E%90/data/image-20230717194900541.png" alt="image-20230717194900541"></p>
<h4 id="basedao-java"><a href="#basedao-java" class="headerlink" title="basedao.java"></a>basedao.java</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson2.JSON;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 18255178159</span></span><br><span class="line"><span class="keyword">import</span> java.sql.*;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BaseDao</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">upd</span><span class="params">(String sql,String ...params)</span>&#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">num</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Class.forName(<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);</span><br><span class="line">            <span class="type">Connection</span> <span class="variable">con</span> <span class="operator">=</span> DriverManager.getConnection</span><br><span class="line">                    (<span class="string">&quot;jdbc:mysql://110.42.223.17:7406/test?serverTimezone=Asia/Shanghai&quot;</span>,</span><br><span class="line">                            <span class="string">&quot;root&quot;</span>,<span class="string">&quot;123456&quot;</span>);</span><br><span class="line">            <span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> con.prepareStatement(</span><br><span class="line">                    sql);</span><br><span class="line">            <span class="keyword">if</span>(params!=<span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; params.length; i++) &#123;</span><br><span class="line">                    ps.setString(i + <span class="number">1</span>, params[i]);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            num = ps.executeUpdate();</span><br><span class="line">            ps.close();</span><br><span class="line">            con.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">b</span> <span class="operator">=</span> num&gt;=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> JSON.toJSONString(<span class="keyword">new</span> <span class="title class_">HashMap</span>()&#123;&#123;</span><br><span class="line">            put(<span class="string">&quot;result&quot;</span>,b);</span><br><span class="line">        &#125;&#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String  <span class="title function_">so</span><span class="params">(String sql,String ...params)</span>&#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">rstr</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Class.forName(<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);</span><br><span class="line">            <span class="type">Connection</span> <span class="variable">con</span> <span class="operator">=</span> DriverManager.getConnection</span><br><span class="line">                    (<span class="string">&quot;jdbc:mysql://110.42.223.17:7406/test&quot;</span>,</span><br><span class="line">                            <span class="string">&quot;root&quot;</span>,<span class="string">&quot;123456&quot;</span>);</span><br><span class="line">            <span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> con.prepareStatement(</span><br><span class="line">                    sql);</span><br><span class="line">            <span class="keyword">if</span>(params!=<span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; params.length; i++) &#123;</span><br><span class="line">                    ps.setString(i + <span class="number">1</span>, params[i]);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> ps.executeQuery();</span><br><span class="line">            <span class="keyword">if</span>(rs.next())&#123;</span><br><span class="line">                rstr = rs.getString(<span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            ps.close();</span><br><span class="line">            con.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> rstr;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String  <span class="title function_">s</span><span class="params">(String sql,String ...params)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> JSON.toJSONString(smap(sql,params));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> List&lt;Map&gt;  <span class="title function_">smap</span><span class="params">(String sql,String ...params)</span>&#123;</span><br><span class="line">        List&lt;Map&gt; mapList = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Class.forName(<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);</span><br><span class="line">            <span class="type">Connection</span> <span class="variable">con</span> <span class="operator">=</span> DriverManager.getConnection</span><br><span class="line">                    (<span class="string">&quot;jdbc:mysql://110.42.223.17:7406/test&quot;</span>,</span><br><span class="line">                            <span class="string">&quot;root&quot;</span>,<span class="string">&quot;123456&quot;</span>);</span><br><span class="line">            <span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> con.prepareStatement(</span><br><span class="line">                    sql);</span><br><span class="line">            <span class="keyword">if</span>(params!=<span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; params.length; i++) &#123;</span><br><span class="line">                    ps.setString(i + <span class="number">1</span>, params[i]);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> ps.executeQuery();</span><br><span class="line">            <span class="type">ResultSetMetaData</span> <span class="variable">rsmd</span> <span class="operator">=</span> ps.getMetaData();</span><br><span class="line">            <span class="keyword">while</span>(rs.next())&#123;</span><br><span class="line">                <span class="type">Map</span> <span class="variable">map</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HashMap</span>();</span><br><span class="line">                <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;rsmd.getColumnCount();i++)&#123;</span><br><span class="line">                    map.put(rsmd.getColumnName(i+<span class="number">1</span>),</span><br><span class="line">                            rs.getObject(rsmd.getColumnName(i+<span class="number">1</span>)));</span><br><span class="line">                &#125;</span><br><span class="line">                mapList.add(map);</span><br><span class="line">            &#125;</span><br><span class="line">            ps.close();</span><br><span class="line">            con.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> mapList;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Class.forName(<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);</span><br><span class="line">            <span class="type">Connection</span> <span class="variable">con</span> <span class="operator">=</span> DriverManager.getConnection</span><br><span class="line">                    (<span class="string">&quot;jdbc:mysql://110.42.223.17:7406/test?serverTimezone=UTC&quot;</span>,</span><br><span class="line">                            <span class="string">&quot;root&quot;</span>,<span class="string">&quot;123456&quot;</span>);</span><br><span class="line">            <span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> con.prepareStatement(</span><br><span class="line">                   <span class="string">&quot;select * from user_zz&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> ps.executeQuery();</span><br><span class="line"></span><br><span class="line">            <span class="type">ResultSetMetaData</span> <span class="variable">rsmd</span> <span class="operator">=</span> ps.getMetaData();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;rsmd.getColumnCount();i++)&#123;</span><br><span class="line">                System.out.println(rsmd.getColumnName(i+<span class="number">1</span>));</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">while</span>(rs.next())&#123;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">            ps.close();</span><br><span class="line">            con.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">//加载JDBC驱动程序</span><br><span class="line">Class.forName(&quot;com.mysql.cj.jdbc.Driver&quot;);</span><br><span class="line">//Connection con创建连接对象</span><br><span class="line">//getConnection获取数据库连接方法</span><br><span class="line"> //创建Connection实例</span><br><span class="line">Connection con = DriverManager.getConnection</span><br><span class="line">          (&quot;jdbc:mysql://110.42.223.17:7406/test?        serverTimezone=Asia/Shanghai&quot;,</span><br><span class="line">                            &quot;root&quot;,&quot;123456&quot;);</span><br><span class="line">PreparedStatement ps = con.prepareStatement(</span><br><span class="line">                    sql); </span><br><span class="line"></span><br><span class="line">执行sql语句并接收返回结果                    </span><br><span class="line">num = ps.executeUpdate();                    </span><br><span class="line">增、删、改 用executeUpdate（）</span><br><span class="line">返回值为int型，表示被影响的行数</span><br><span class="line"></span><br><span class="line">获取结果集</span><br><span class="line">ResultSet rs = ps.executeQuery();</span><br><span class="line">查用executeQuery() 返回的是一个集合</span><br><span class="line"></span><br><span class="line">释放资源</span><br><span class="line">ps.close();</span><br><span class="line">con.close();</span><br><span class="line"></span><br><span class="line">查询所有内容,返回一个map表</span><br><span class="line">List&lt;Map&gt; </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">getColumnCount()：返回当前 ResultSet 对象中的列数。</span><br><span class="line">getColumnName(int column)：获取指定列的名称</span><br><span class="line">获取对象的当前行中指定列名称的值作为 Java 编程语言中的一个对象。</span><br><span class="line">ResultSet.getObject ()将从 ResultSet 的当前行检索数据并从索引 1 开始。</span><br><span class="line">for(int i=0;i&lt;rsmd.getColumnCount();i++)&#123;</span><br><span class="line">     map.put(rsmd.getColumnName(i+1),</span><br><span class="line">         rs.getObject(rsmd.getColumnName(i+1)));</span><br><span class="line"></span><br><span class="line">next（）表示 指针先下一行，还有first（）指向第一行 、last（）指向最后一行、如果有数据就返回true</span><br><span class="line">rs.next()只要结果集里，至少有一个记录，next方法就会返回true</span><br></pre></td></tr></table></figure>

<h3 id="后端"><a href="#后端" class="headerlink" title="后端"></a>后端</h3><h4 id="address"><a href="#address" class="headerlink" title="address"></a>address</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Address</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">list</span><span class="params">(Request req)</span>&#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">token</span> <span class="operator">=</span> req.headers.get(<span class="string">&quot;token&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">uid</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BaseDao</span>().so</span><br><span class="line">                (<span class="string">&quot;select id from user_zz where token=?&quot;</span>, token);</span><br><span class="line">        System.out.println(<span class="string">&quot;uid:&quot;</span>+uid);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">BaseDao</span>().s(<span class="string">&quot;select * from address where user_zz_id=?&quot;</span>,</span><br><span class="line">                uid);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">add</span><span class="params">(Request req)</span>&#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">token</span> <span class="operator">=</span> req.headers.get(<span class="string">&quot;token&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">uid</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BaseDao</span>().so</span><br><span class="line">                    (<span class="string">&quot;select id from user_zz where token=?&quot;</span>, token);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">BaseDao</span>().upd(<span class="string">&quot;insert into address values(null,?,?,?)&quot;</span>,</span><br><span class="line">                    uid, req.params.get(<span class="string">&quot;pcd&quot;</span>), req.params.get(<span class="string">&quot;detail&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">del</span><span class="params">(Request req)</span>&#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">token</span> <span class="operator">=</span> req.headers.get(<span class="string">&quot;token&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">uid</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BaseDao</span>().so</span><br><span class="line">                (<span class="string">&quot;select id from user_zz where token=?&quot;</span>, token);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">BaseDao</span>().upd(<span class="string">&quot;delete from address where user_zz_id=? &quot;</span> +</span><br><span class="line">                        <span class="string">&quot;and id=?&quot;</span>,</span><br><span class="line">                uid,req.params.get(<span class="string">&quot;id&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;    </span><br></pre></td></tr></table></figure>

<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">list:地址列表</span><br><span class="line"></span><br><span class="line">add:添加地址</span><br><span class="line"></span><br><span class="line">del:删除地址</span><br><span class="line"></span><br><span class="line">token-用户身份验证的令牌-用户唯一标识字符串</span><br><span class="line"></span><br><span class="line">headers请求头</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">JSON.parse():JSON字符串转对象/值</span><br><span class="line">JSON.stringify():对象/值转JSON字符串</span><br></pre></td></tr></table></figure>

<h4 id="alipay"><a href="#alipay" class="headerlink" title="alipay"></a>alipay</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson2.JSONObject;</span><br><span class="line"><span class="keyword">import</span> com.alipay.api.AlipayApiException;</span><br><span class="line"><span class="keyword">import</span> com.alipay.api.AlipayClient;</span><br><span class="line"><span class="keyword">import</span> com.alipay.api.DefaultAlipayClient;</span><br><span class="line"><span class="keyword">import</span> com.alipay.api.request.AlipayTradePagePayRequest;</span><br><span class="line"><span class="keyword">import</span> com.alipay.api.response.AlipayTradePagePayResponse;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.text.SimpleDateFormat;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Alipay</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">//System.out.println();</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">pay</span><span class="params">(String uid,String title,<span class="type">double</span> price)</span> <span class="keyword">throws</span> AlipayApiException &#123;</span><br><span class="line">        <span class="comment">//1、封装client客户端 </span></span><br><span class="line">        <span class="type">AlipayClient</span> <span class="variable">alipayClient</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DefaultAlipayClient</span></span><br><span class="line">                (<span class="string">&quot;https://openapi.alipay.com/gateway.do&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;2021002138636792&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;MIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQCJsOkxuiDHQwOIu2QGm8EndprrJLSgkCXoy49kTDLusJUBDmut47PfDzHWiW9CBCd/+yCrc6ZUnOUGkm20J0XjDZ0l2eOcvIpf9l1MuWrPP16W/mY7+ann3sla8RvaHPDC4zNBCn9UA4zx1VyQGkn4SYbxqQ9RZMsQSamZ8xXF6hTVePwxCJMwAtoCMxxdgCQHz2b0TctvUOtXeNRE2DcyxxgkCTMb58bBuDQyppIun/DIBt1PhEZ5/LBLPYGR3lhPXIjlndLaHiElDNeGysgpyfuMsBpgBNQ3xE3Ax4DdXKAvkFPUpS0RJ5dfSSFFBB7Unhxq/QXdr8Hwp0pdv/TZAgMBAAECggEBAIFTM8QsESt3KvObJlj6pBIf2WQwpqMEoUalIzpOQ6xjGKDUXZkG/OPujp31mhVEd6FCSy4eQsTIVGi20ela1c5r9AUgQSPvBn0ZlgpBQSwFVh+2NGnyln4dh7wuKD3V3uD9qx9U78EGULS39Oe4eW+GCAQlCSkm5X+X4H+jjPjFAjTOke3wgiZASIXj+sf1ibFD9imiMGmEAuOE5Hc6RznyOHm8hO0n3QP1DNAGkpdUOS2imShqjJMu22rxNRmNGFAWvo1+DZoae1gjhGLYdTWGv/lzgms9MvI/MI0ITf7MJr9Wb3MD7IxTtKGZCzLPGj6u/xJCK1i0kyqi5Usm5wECgYEAvgHwXhACz4rbE3ol0kvp3aL3Wl0PlxHmVxE8PYroPU6SwHkZZ7pWhozBHhqBvdFKnlqjRNtpW+XVxeZOUmSmufX8Swr6kui3/tMLLOizSEYEY0BWxLqaRAUxV+05ZCydTFBrp5DJNHNXf+4JV4IW/fWv8lIwJQitCc3JQa2HymECgYEAuYNgVOn2FKpStFXrLOYHmyC3/rGIssErZVGBBfNyjxpVqWLCYpDwHCvB1CA00nGPB01FW24hSruycH+Oj5BbG1slu1bKUFL7jXJHruhy+ETGF4ajSdCv1kXapMKyE/XjX+J3JxqmyPeTvgEdVSfB023drw4nDpN97kz0d50mbXkCgYB4b/gxV0rAzQ5CUUmJ/C54G2VYdOZ95o2voLAjflnpClYBBIGy+yz/Slbawwh8Dh6TM3aMHduxsYSIVYxNs5jvBNnvozzjQ/nk31cVF0cUx7TeSJj3SCSievwk9KxNL+5gwhUK+L5grb/HylVHj6ENRt9I5Qm5X793GGa6Z8lL4QKBgQCMgLghF+HM3QMumjQ4GTCBiVJRkFycJjmbzxMNUsjdIXDnjWj0BhoU+/8djhbznBZbzWZOTSbh1y7ajYGHsimOmoYFUUKBe5gSFQ+9pUgOSOhPQSXC7k9+1gE28E63V3ASWw8rir/vTbOUIHv61tWyMG/J+coS/BpQtfAh99/24QKBgFQwMZpoLU17re1rZgKrnQh1v7tthknc4DRiUshW6VmKLeVacRn8cUHKJfJP+eW4Eb2Gap8Ody8IxiiqwA23U04Vh2N439xel2w9u4xxS3k20zaCKhVE+rbP1MGDps7Ef5FcjKz2ZU/LpCxWSdUz+dqu6l7XMDYJPzgQ7dhnVjrA&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;json&quot;</span>,<span class="string">&quot;UTF-8&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAibDpMbogx0MDiLtkBpvBJ3aa6yS0oJAl6MuPZEwy7rCVAQ5rreOz3w8x1olvQgQnf/sgq3OmVJzlBpJttCdF4w2dJdnjnLyKX/ZdTLlqzz9elv5mO/mp597JWvEb2hzwwuMzQQp/VAOM8dVckBpJ+EmG8akPUWTLEEmpmfMVxeoU1Xj8MQiTMALaAjMcXYAkB89m9E3Lb1DrV3jURNg3MscYJAkzG+fGwbg0MqaSLp/wyAbdT4RGefywSz2Bkd5YT1yI5Z3S2h4hJQzXhsrIKcn7jLAaYATUN8RNwMeA3VygL5BT1KUtESeXX0khRQQe1J4cav0F3a/B8KdKXb/02QIDAQAB&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;RSA2&quot;</span>);</span><br><span class="line">        <span class="comment">//2、始化一个阿里封装的request，后面几句就是设置这个request要传入的参数，把回调函数地址，外部订单好，金额都设置到request里面。 </span></span><br><span class="line">        <span class="type">AlipayTradePagePayRequest</span> <span class="variable">request</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AlipayTradePagePayRequest</span>();</span><br><span class="line">        <span class="comment">//回调地址</span></span><br><span class="line">        <span class="comment">// 服务器异步通知页面路径  </span></span><br><span class="line">        request.setNotifyUrl(<span class="string">&quot;http://49.234.118.107:7630/article_notify&quot;</span>);</span><br><span class="line">        <span class="comment">// 页面跳转同步通知页面路径</span></span><br><span class="line">        <span class="comment">//request.setReturnUrl(&quot;&quot;);</span></span><br><span class="line">        <span class="comment">//实例化一个 JSONObject 对象</span></span><br><span class="line">        <span class="type">JSONObject</span> <span class="variable">bizContent</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JSONObject</span>();</span><br><span class="line">        <span class="comment">//使用 SimpleDateFormat 格式化日期</span></span><br><span class="line">        <span class="comment">//使用SimpleDateFormat的format方法，将一个Date类型转化成String类型，并且可以指定输出格式。</span></span><br><span class="line">        <span class="comment">//末尾的+&quot;&quot;通过将数字与空字符串连接来将数字转换为字符串。</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">orderNo</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SimpleDateFormat</span>(<span class="string">&quot;yyyyMMddHHmmssSSS&quot;</span>)</span><br><span class="line">                .format(<span class="keyword">new</span> <span class="title class_">Date</span>())+(Math.random()+<span class="string">&quot;&quot;</span>).substring(<span class="number">10</span>,<span class="number">15</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">BaseDao</span>().upd(<span class="string">&quot;insert into `order`&quot;</span> +</span><br><span class="line">                <span class="string">&quot;(user_zz_id,orderno,orderstatus,createtime) &quot;</span> +</span><br><span class="line">                <span class="string">&quot;values(?,?,&#x27;待支付&#x27;,now())&quot;</span>,uid,orderNo);</span><br><span class="line">        <span class="comment">//JSONObject按put顺序排放与输出,key值相同会覆盖原值。</span></span><br><span class="line">        bizContent.put(<span class="string">&quot;out_trade_no&quot;</span>,orderNo);<span class="comment">//</span></span><br><span class="line">        bizContent.put(<span class="string">&quot;total_amount&quot;</span>, price);</span><br><span class="line">        bizContent.put(<span class="string">&quot;subject&quot;</span>, title);</span><br><span class="line">        bizContent.put(<span class="string">&quot;product_code&quot;</span>, <span class="string">&quot;FAST_INSTANT_TRADE_PAY&quot;</span>);</span><br><span class="line">        bizContent.put(<span class="string">&quot;qr_pay_mode&quot;</span>,<span class="number">4</span>);</span><br><span class="line">        bizContent.put(<span class="string">&quot;qrcode_width&quot;</span>,<span class="number">100</span>);</span><br><span class="line">        <span class="comment">//用于设置支付宝请求对象的业务内容的代码片段。</span></span><br><span class="line">        request.setBizContent(bizContent.toString());</span><br><span class="line">        <span class="comment">//以下两行可向支付宝发起一个下单请求，支付宝返回给我们的是一个字符串，这个字符串实际上是一个form表单。</span></span><br><span class="line">        <span class="type">AlipayTradePagePayResponse</span> <span class="variable">response</span> <span class="operator">=</span> alipayClient.pageExecute(request);</span><br><span class="line">        <span class="keyword">return</span> response.getBody();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>**AlipayClient 接口:**声明了调用各种请求的方法;主要实现类;DefaultAlipayClient;实现类实现了接口中的各个方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">AlipayClient</span> <span class="variable">alipayClient</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DefaultAlipayClient</span>(URL, APP_ID, APP_PRIVATE_KEY, FORMAT, CHARSET, ALIPAY_PUBLIC_KEY, SIGN_TYPE);</span><br></pre></td></tr></table></figure>

<p><img src="/data/image-20230716164252162.png" alt="image-20230716164252162"></p>
<table>
<thead>
<tr>
<th>参数</th>
<th>解释</th>
</tr>
</thead>
<tbody><tr>
<td>serverurl</td>
<td>支付宝网关（固定）</td>
</tr>
<tr>
<td>appid</td>
<td><em>应用ID,您的APPID，收款账号既是您的APPID对应支付宝账号</em></td>
</tr>
<tr>
<td>privateKey</td>
<td><em>商户私钥</em></td>
</tr>
<tr>
<td>format</td>
<td>参数返回格式，只支持 json；默认json</td>
</tr>
<tr>
<td>charset</td>
<td>编码集，支持 GBK&#x2F;UTF-8</td>
</tr>
<tr>
<td>alipayPulicKey</td>
<td>支付宝公钥</td>
</tr>
<tr>
<td>signtype</td>
<td>商户生成签名字符串所使用的签名算法类型，目前支持 RSA2 和 RSA，推荐使用 RSA2；默认是 RSA</td>
</tr>
</tbody></table>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">AlipayTradePagePayRequest</span> <span class="variable">request</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AlipayTradePagePayRequest</span>();</span><br><span class="line"></span><br><span class="line">此代码创建一个新对象。AlipayTradePagePayRequest</span><br><span class="line">该类由支付宝SDK提供，用于向支付宝发起新的支付请求。此请求包括有关付款金额、货币以及处理付款交易所需的其他详细信息的信息。AlipayTradePagePayRequest</span><br><span class="line">创建对象后，商家可以在发送到支付宝进行处理之前对其进行相应的配置。这包括设置支付宝处理付款所需的付款金额、币种、产品信息和其他参数。AlipayTradePagePayRequest</span><br><span class="line">请求发送后，支付宝将处理支付交易，并向商家返回响应，表明支付是否成功。</span><br></pre></td></tr></table></figure>

<p>**AlipayTradePagePayRequest:**支付宝交易页面支付请求</p>
<p>支付宝的支付通知：ReturnUrl和NotifyUrl:都需要在设置AlipayTradeWapPayRequest时设置为通知接口，然后作为参数传递给支付宝。交易完成后，支付宝会按照设置的通知url请求验证，然后根据结果进行处理。</p>
<table>
<thead>
<tr>
<th></th>
<th>ReturnUrl</th>
<th>NotifyUrl</th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td>同步返回URL，对应同步返回接口，是一个页面跳转通知（支付成功后，从支付宝跳转到指定的地址，该地址请求对应接口）</td>
<td>异步通知的URL，对应异步通知接口，为一个服务器后台通知，该URL是支付宝服务器端自动调用商户服务端接口的地址，支付成功后调用，再根据支付宝转发的参数进行订单状态处理</td>
</tr>
<tr>
<td>获取参数方式</td>
<td>同步的get请求</td>
<td>异步的post请求</td>
</tr>
<tr>
<td>接口返回结果</td>
<td>跳转至指定的通知页面</td>
<td>返回字符串”success”或者”fail”，不能带有任何HTML信息。</td>
</tr>
<tr>
<td>通知次数</td>
<td>只进行一次通知跳转</td>
<td>至少一次,如果不成功，支付宝服务器会不断重发通知，直到返回success</td>
</tr>
</tbody></table>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">request.setNotifyUrl(&quot;http://49.234.118.107:7630/article_notify&quot;);</span><br><span class="line">此代码设置支付宝付款请求的通知 URL。</span><br><span class="line">通知 URL 是支付宝向商家服务器发送有关支付交易状态的异步通知消息的端点。通过设置通知URL，商家能够接收有关付款状态的实时更新，从而使他们能够相应地处理和更新订单。</span><br><span class="line">在这种情况下，通知 URL 设置为“http://49.234.118.107:7630/article_notify”。这是商家服务器上的端点，支付宝将在其中发送有关支付交易的通知消息。商家应确保其服务器已正确配置为接收和处理这些消息。</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">JSONObject</span> <span class="variable">obj</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JSONObject</span>();</span><br><span class="line">obj.put(key, value);</span><br></pre></td></tr></table></figure>

<p> <strong>JSONObject:</strong></p>
<p>直接构建即直接实例化一个 JSONObject 对象，而后调用其 put() 方法，将数据写入。put() 方法的第一个参数为 key 值，必须为 String 类型，第二个参数为 value，可以为 boolean、double、int、long、Object、Map 以及 Collection 等。当然，double 以及 int 等类型只是在 Java 中，写入到 json 中时，统一都会以 Number 类型存储。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">SimpleDateFormat(&quot;yyyyMMddHHmmssSSS&quot;)</span><br><span class="line">                .format(new Date())+(Math.random()+&quot;&quot;).substring(10,15);</span><br><span class="line">此代码片段用于使用当前日期和随机数生成唯一的交易编号。</span><br><span class="line"></span><br><span class="line">代码的第一部分使用 SimpleDateFormat 类创建日期格式，格式为“yyyyMMddHHmmssSSS”，它以“年、月、日、小时、分钟、秒、毫秒”的格式表示当前日期和时间。</span><br><span class="line">然后，在 SimpleDateFormat 对象上调用“.format（new Date（））”方法，以根据指定的格式设置当前日期和时间的格式。</span><br><span class="line">代码的第二部分使用 Math.random（） 方法生成一个随机数，使用“+”运算符将其转换为字符串，并从第 10 个字符到第 15 个字符中获取结果字符串的子字符串。</span><br><span class="line">最后，将两个字符串连接起来以形成当前日期和时间唯一的交易编号以及生成的随机数。此交易编号可用于跟踪和识别正在处理的特定交易。               </span><br></pre></td></tr></table></figure>

<p><strong>SimpleDateFormat:</strong></p>
<p>使用SimpleDateFormat的format方法，将一个Date类型转化成String类型，并且可以指定输出格式format方法，可以把Date型的字符串转换成特定格式的String类型日期，如果Date类型和定义的SimpleDateFormat长度不一致会自动在后面补充0。</p>
<p><strong>Math.random()：</strong>产生一个[0，1)之间的随机数</p>
<p><strong>反引号 &#96;：</strong>它是为了区分MYSQL的保留字与普通字符而引入的符号。<br>注意划重点：有MYSQL保留字作为字段的，必须加上反引号来区分！！！<br>所谓的保留字就是select database insert 这一类数据库的sql指令，当我们不得已要拿他们来做表名和字段名的时候 我们必须要加反引号来避免编译器把这部分认为是保留字而产生错误。<br>加反引号只是作一个保险。务必要记住：保留字既不能作为表名，也不能作为字段名，如果非要这么操作，请记住要增加反引号！</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alipayRequest.setBizContent(bizContent.toString());</span><br></pre></td></tr></table></figure>

<p>这是Java程序中通常用于设置支付宝请求对象的业务内容的代码片段。<br>&#x3D;&#x3D;alipayRequest”变量是表示支付宝请求的类的对象。&#x3D;&#x3D;<br>&#x3D;&#x3D;”setBizContent()”方法是类提供的设置支付宝请求业务内容的方法。&#x3D;&#x3D;<br>&#x3D;&#x3D;“bizContent”变量通常是一个JSON对象，其中包含特定于所发出支付宝请求的业务逻辑的数据。&#x3D;&#x3D;<br>在“bizContent”对象上调用“.toString（）”将其转换为字符串表示形式，然后可以将其作为支付宝请求的有效负载传递给支付宝平台进行处理。</p>
<pre><code>AlipayTradePagePayResponse response = alipayClient.pageExecute(request);
    return response.getBody();
</code></pre>
<p>这是 Java 程序中通常用于执行支付宝交易页面支付请求并检索响应的代码片段。<br><strong>“alipayClient”变量是代表支付宝客户端的类的对象，负责向支付宝平台发出请求。“request”变量是表示支付宝交易页面支付请求的类的对象。</strong><br><strong>“pageExecute（）”方法在“alipayClient”对象上调用，并将“request”对象作为其参数传递。该方法将请求发送到支付宝平台，并等待响应。</strong><br><strong>“response”变量是一个类的对象，该类表示支付宝交易页面支付响应，该响应由“pageExecute（）”方法返回。然后在“response”对象上调用“getBody（）”方法，以字符串形式检索响应的正文。</strong><br>此代码片段可用于将支付宝交易页面支付功能集成到 Java 程序中，方法是向支付宝平台发出请求并接收支付响应。</p>
<p><strong>其他：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">pay:支付</span><br><span class="line"></span><br><span class="line">长为私钥</span><br><span class="line"></span><br><span class="line">公网能访问的地址-回调地址</span><br><span class="line">http://49.234.118.107:7630/article_notify</span><br><span class="line">request.setNotifyUrl(&quot;http://49.234.118.107:7630/article_notify&quot;)</span><br><span class="line">此代码将请求通知 URL 用于在发生事件（例如付款成功或交易失败）时向服务器发送通知。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">orderNo:订单编号</span><br><span class="line"></span><br><span class="line">notify_url异步通知地址</span><br><span class="line"></span><br><span class="line">out_trade_no:String     商家订单号。原支付请求的商家订单号</span><br><span class="line">由商家自定义，64个字符以内，仅支持字母、数字、下划线且需保证在商户端不重复。</span><br><span class="line"></span><br><span class="line">total_amount:订单金额。本次交易支付订单金额，单位为人民币（元），精确到小数点后 2 位</span><br><span class="line"></span><br><span class="line">subject:订单标题/商品标题/交易标题/订单关键字等，是请求时对应参数，会在通知中原样传回</span><br><span class="line"></span><br><span class="line">product_code:销售产品码，与支付宝签约的产品码名称。注：目前电脑支付场景下仅支持FAST_INSTANT_TRADE_PAY</span><br><span class="line"></span><br><span class="line">qr_pay_mode:PC扫码支付的方式。支持前置模式和跳转模式。</span><br><span class="line"></span><br><span class="line">qrcode_width:商户自定义二维码宽度。</span><br><span class="line">注：qr_pay_mode=4时该参数有效</span><br><span class="line"></span><br><span class="line">qrcodeL:二维码</span><br></pre></td></tr></table></figure>

<h4 id="article"><a href="#article" class="headerlink" title="article"></a>article</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson2.JSON;</span><br><span class="line"><span class="keyword">import</span> com.alipay.api.AlipayApiException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Article</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">delpaylist</span><span class="params">(Request req)</span>&#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">token</span> <span class="operator">=</span> req.headers.get(<span class="string">&quot;token&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">telephone</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BaseDao</span>().so</span><br><span class="line">                (<span class="string">&quot;select telephone from user_zz where token=?&quot;</span>, token);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">BaseDao</span>().upd(<span class="string">&quot;delete from paylist where telephone=?&quot;</span>,telephone);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//支付信息通知</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">notify</span><span class="params">(Request req)</span>&#123;</span><br><span class="line">      <span class="comment">//  System.out.println(req.params.get(&quot;trade_status&quot;));//支付状态</span></span><br><span class="line">      <span class="comment">//  System.out.println(req.params.get(&quot;total_amount&quot;));//支付总钱数</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">orderno</span> <span class="operator">=</span> req.params.get(<span class="string">&quot;out_trade_no&quot;</span>);</span><br><span class="line">      <span class="comment">//  System.out.println(orderno);</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//根据订单号找到用户uid</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">uid</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BaseDao</span>().so(<span class="string">&quot;select user_zz_id from `order` &quot;</span> +</span><br><span class="line">                <span class="string">&quot; where orderno=? &quot;</span>,orderno);</span><br><span class="line">        <span class="comment">//根据用户uid找到手机号码</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">telephone</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BaseDao</span>().so</span><br><span class="line">                (<span class="string">&quot;select telephone from user_zz where id=?&quot;</span>, uid);</span><br><span class="line">        <span class="comment">//电话号；更新积分</span></span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">BaseDao</span>().upd(<span class="string">&quot;update user_zz set score2 = score2+300 &quot;</span> +</span><br><span class="line">                <span class="string">&quot;where telephone=?&quot;</span>,telephone);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//钱；更新订单</span></span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">BaseDao</span>().upd(<span class="string">&quot;update `order` set orderstatus=&#x27;已支付&#x27;,&quot;</span> +</span><br><span class="line">                <span class="string">&quot;paytime=now(),money=? &quot;</span> +</span><br><span class="line">                <span class="string">&quot;where user_zz_id=? and orderno=?&quot;</span>,</span><br><span class="line">                req.params.get(<span class="string">&quot;total_amount&quot;</span>),uid,orderno);</span><br><span class="line">        <span class="comment">//支付状态</span></span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">BaseDao</span>().upd(<span class="string">&quot;insert into paylist values(null,?)&quot;</span>,telephone);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//检查支付</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">checkpay</span><span class="params">(Request req)</span>&#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">token</span> <span class="operator">=</span> req.headers.get(<span class="string">&quot;token&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">telephone</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BaseDao</span>().so</span><br><span class="line">                (<span class="string">&quot;select telephone from user_zz where token=?&quot;</span>, token);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">BaseDao</span>().so(<span class="string">&quot;select 1 from paylist where &quot;</span> +</span><br><span class="line">                <span class="string">&quot;telephone=?&quot;</span>,telephone);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">pay</span><span class="params">(Request req)</span>&#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">title</span> <span class="operator">=</span> req.params.get(<span class="string">&quot;title&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">price</span> <span class="operator">=</span> req.params.get(<span class="string">&quot;price&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">token</span> <span class="operator">=</span> req.params.get(<span class="string">&quot;token&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">uid</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BaseDao</span>().so</span><br><span class="line">                (<span class="string">&quot;select id from user_zz where token=?&quot;</span>, token);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> Alipay.pay(uid,title,Double.parseDouble(price));</span><br><span class="line">            <span class="comment">//return JSON.toJSONString(new HashMap()&#123;&#123;</span></span><br><span class="line">             <span class="comment">//   put(&quot;result&quot;,Alipay.pay(title,Double.parseDouble(price)));</span></span><br><span class="line">            <span class="comment">//&#125;&#125;);</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (AlipayApiException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">list</span><span class="params">(Request req)</span>&#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select * from article&quot;</span>;</span><br><span class="line">        List&lt;String&gt; params = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">if</span>(req.params.get(<span class="string">&quot;aid&quot;</span>)!=<span class="literal">null</span>)&#123;</span><br><span class="line">            sql = sql + <span class="string">&quot; where id=?&quot;</span>;</span><br><span class="line">            params.add(req.params.get(<span class="string">&quot;aid&quot;</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        List&lt;Map&gt; list = <span class="keyword">new</span> <span class="title class_">BaseDao</span>().smap(sql,</span><br><span class="line">                params.toArray(<span class="keyword">new</span> <span class="title class_">String</span>[]&#123;&#125;));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(Map m:list)&#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">contentstr</span> <span class="operator">=</span> m.get(<span class="string">&quot;content&quot;</span>)+<span class="string">&quot;&quot;</span>;</span><br><span class="line">            <span class="comment">// 在前端要求用户内容必须大于等于100字</span></span><br><span class="line">            <span class="type">int</span> <span class="variable">x</span> <span class="operator">=</span> (<span class="type">int</span>) (contentstr.length()*<span class="number">0.25</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">preContent</span> <span class="operator">=</span> contentstr.substring(<span class="number">0</span>,x);</span><br><span class="line">            m.put(<span class="string">&quot;content&quot;</span>,preContent);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> JSON.toJSONString(list);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">list2</span><span class="params">(Request req)</span>&#123;</span><br><span class="line"></span><br><span class="line">        List&lt;Map&gt; list = <span class="keyword">new</span> <span class="title class_">BaseDao</span>().smap(<span class="string">&quot;select * from article where id=?&quot;</span>,</span><br><span class="line">                req.params.get(<span class="string">&quot;id&quot;</span>));</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">token</span> <span class="operator">=</span> req.headers.get(<span class="string">&quot;token&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">telephone</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BaseDao</span>().so</span><br><span class="line">                (<span class="string">&quot;select telephone from user_zz where token=?&quot;</span>, token);</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">s1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BaseDao</span>().upd(<span class="string">&quot;update user_zz set score2=score2-30  &quot;</span> +</span><br><span class="line">                <span class="string">&quot;where telephone=? and score2&gt;=30&quot;</span>,telephone);</span><br><span class="line">        <span class="keyword">if</span>(s1.contains(<span class="string">&quot;false&quot;</span>))&#123;</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">BaseDao</span>().upd(<span class="string">&quot;update user_zz set score1=score1-30  &quot;</span> +</span><br><span class="line">                    <span class="string">&quot;where telephone=? and score1&gt;=30&quot;</span>,telephone);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> JSON.toJSONString(list);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">add</span><span class="params">(Request req)</span>&#123;</span><br><span class="line">        <span class="comment">//get req.params</span></span><br><span class="line">        <span class="comment">//post req.json</span></span><br><span class="line">        <span class="keyword">if</span>((req.json.get(<span class="string">&quot;content&quot;</span>)+<span class="string">&quot;&quot;</span>).length()&lt;<span class="number">100</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;error&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">BaseDao</span>().upd(<span class="string">&quot;insert into article values(null,?,?,?,?,?)&quot;</span>,</span><br><span class="line">                req.json.get(<span class="string">&quot;title&quot;</span>)+<span class="string">&quot;&quot;</span>,</span><br><span class="line">                req.json.get(<span class="string">&quot;content&quot;</span>)+<span class="string">&quot;&quot;</span>,</span><br><span class="line">                req.json.get(<span class="string">&quot;type&quot;</span>)+<span class="string">&quot;&quot;</span>,</span><br><span class="line">                req.json.get(<span class="string">&quot;topic_framework_id&quot;</span>)+<span class="string">&quot;&quot;</span>,</span><br><span class="line">                req.json.get(<span class="string">&quot;catagory_id&quot;</span>)+<span class="string">&quot;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">delpaylist</span><br><span class="line">notify:交易通知（）</span><br><span class="line">checkpay:查看支付情况</span><br><span class="line">pay:支付</span><br><span class="line">list:文章列表-未购买所能的查看内容</span><br><span class="line">list2:</span><br><span class="line"></span><br><span class="line">？？定时24小时未支付 已取消订单</span><br><span class="line"></span><br><span class="line">查看交易状态</span><br><span class="line">System.out.println(req.params.get(&quot;trade_status&quot;));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">select 1 from paylist</span><br><span class="line">“从支付列表中选择 1”是一个 SQL 查询，它从“支付列表”表中选择值“1”。</span><br><span class="line">此查询不会从表中检索任何特定数据，而只是检查表是否可访问，如果是，则返回值“1”。</span><br><span class="line">在 SQL 中，SELECT 语句用于从数据库中的一个或多个表中检索数据。</span><br><span class="line">在这种情况下，“1”是一个占位符，它可以替换为“支付列表”表中存在的任何其他值或列名。</span><br><span class="line"></span><br><span class="line">在前端要求用户内容必须大于等于100字</span><br><span class="line">可以看到的内容</span><br><span class="line">String contentstr = m.get(&quot;content&quot;)+&quot;&quot;;         </span><br><span class="line">int x = (int) (contentstr.length()*0.25);</span><br><span class="line">String preContent = contentstr.substring(0,x);</span><br><span class="line"></span><br><span class="line">花费积分的内容</span><br><span class="line">List&lt;Map&gt; list</span><br><span class="line"></span><br><span class="line">扣积分</span><br><span class="line">String s1</span><br><span class="line"></span><br><span class="line">get和post对数据的处理</span><br><span class="line">get req.params</span><br><span class="line">post req.json req.params</span><br><span class="line"></span><br><span class="line">后端判断：判断内容是否有100字</span><br><span class="line">ql相同名称（id）记录数量求和？</span><br><span class="line">select  user_zz_id,sum(money)as amount from `order` GROUP BY user_zz_id;</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>mql相同名称（id）记录数量求和？</th>
</tr>
</thead>
<tbody><tr>
<td>select  user_zz_id,sum(money)as amount from <code>order</code> GROUP BY user_zz_id;</td>
</tr>
<tr>
<td><img src="/../t_%E4%BB%A3%E7%A0%81%E6%8A%A5%E9%94%99%E4%B8%8E%E5%88%86%E6%9E%90/data/image-20230718115442019-16896524841321.png" alt="image-20230718115442019"></td>
</tr>
</tbody></table>
<h4 id="catagory"><a href="#catagory" class="headerlink" title="catagory"></a>catagory</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson2.JSON;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 18255178159</span></span><br><span class="line"><span class="keyword">import</span> java.sql.*;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BaseDao</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">upd</span><span class="params">(String sql,String ...params)</span>&#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">num</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Class.forName(<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);</span><br><span class="line">            <span class="type">Connection</span> <span class="variable">con</span> <span class="operator">=</span> DriverManager.getConnection</span><br><span class="line">                    (<span class="string">&quot;jdbc:mysql://110.42.223.17:7406/test?serverTimezone=Asia/Shanghai&quot;</span>,</span><br><span class="line">                            <span class="string">&quot;root&quot;</span>,<span class="string">&quot;123456&quot;</span>);</span><br><span class="line">            <span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> con.prepareStatement(</span><br><span class="line">                    sql);</span><br><span class="line">            <span class="keyword">if</span>(params!=<span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; params.length; i++) &#123;</span><br><span class="line">                    ps.setString(i + <span class="number">1</span>, params[i]);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            num = ps.executeUpdate();</span><br><span class="line">            ps.close();</span><br><span class="line">            con.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">b</span> <span class="operator">=</span> num&gt;=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> JSON.toJSONString(<span class="keyword">new</span> <span class="title class_">HashMap</span>()&#123;&#123;</span><br><span class="line">            put(<span class="string">&quot;result&quot;</span>,b);</span><br><span class="line">        &#125;&#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String  <span class="title function_">so</span><span class="params">(String sql,String ...params)</span>&#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">rstr</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Class.forName(<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);</span><br><span class="line">            <span class="type">Connection</span> <span class="variable">con</span> <span class="operator">=</span> DriverManager.getConnection</span><br><span class="line">                    (<span class="string">&quot;jdbc:mysql://110.42.223.17:7406/test&quot;</span>,</span><br><span class="line">                            <span class="string">&quot;root&quot;</span>,<span class="string">&quot;123456&quot;</span>);</span><br><span class="line">            <span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> con.prepareStatement(</span><br><span class="line">                    sql);</span><br><span class="line">            <span class="keyword">if</span>(params!=<span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; params.length; i++) &#123;</span><br><span class="line">                    ps.setString(i + <span class="number">1</span>, params[i]);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> ps.executeQuery();</span><br><span class="line">            <span class="keyword">if</span>(rs.next())&#123;</span><br><span class="line">                rstr = rs.getString(<span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            ps.close();</span><br><span class="line">            con.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> rstr;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String  <span class="title function_">s</span><span class="params">(String sql,String ...params)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> JSON.toJSONString(smap(sql,params));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> List&lt;Map&gt;  <span class="title function_">smap</span><span class="params">(String sql,String ...params)</span>&#123;</span><br><span class="line">        List&lt;Map&gt; mapList = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Class.forName(<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);</span><br><span class="line">            <span class="type">Connection</span> <span class="variable">con</span> <span class="operator">=</span> DriverManager.getConnection</span><br><span class="line">                    (<span class="string">&quot;jdbc:mysql://110.42.223.17:7406/test&quot;</span>,</span><br><span class="line">                            <span class="string">&quot;root&quot;</span>,<span class="string">&quot;123456&quot;</span>);</span><br><span class="line">            <span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> con.prepareStatement(</span><br><span class="line">                    sql);</span><br><span class="line">            <span class="keyword">if</span>(params!=<span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; params.length; i++) &#123;</span><br><span class="line">                    ps.setString(i + <span class="number">1</span>, params[i]);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> ps.executeQuery();</span><br><span class="line">            <span class="type">ResultSetMetaData</span> <span class="variable">rsmd</span> <span class="operator">=</span> ps.getMetaData();</span><br><span class="line">            <span class="keyword">while</span>(rs.next())&#123;</span><br><span class="line">                <span class="type">Map</span> <span class="variable">map</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HashMap</span>();</span><br><span class="line">                <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;rsmd.getColumnCount();i++)&#123;</span><br><span class="line">                    map.put(rsmd.getColumnName(i+<span class="number">1</span>),</span><br><span class="line">                            rs.getObject(rsmd.getColumnName(i+<span class="number">1</span>)));</span><br><span class="line">                &#125;</span><br><span class="line">                mapList.add(map);</span><br><span class="line">            &#125;</span><br><span class="line">            ps.close();</span><br><span class="line">            con.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> mapList;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Class.forName(<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);</span><br><span class="line">            <span class="type">Connection</span> <span class="variable">con</span> <span class="operator">=</span> DriverManager.getConnection</span><br><span class="line">                    (<span class="string">&quot;jdbc:mysql://110.42.223.17:7406/test?serverTimezone=UTC&quot;</span>,</span><br><span class="line">                            <span class="string">&quot;root&quot;</span>,<span class="string">&quot;123456&quot;</span>);</span><br><span class="line">            <span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> con.prepareStatement(</span><br><span class="line">                   <span class="string">&quot;select * from user_zz&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> ps.executeQuery();</span><br><span class="line"></span><br><span class="line">            <span class="type">ResultSetMetaData</span> <span class="variable">rsmd</span> <span class="operator">=</span> ps.getMetaData();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;rsmd.getColumnCount();i++)&#123;</span><br><span class="line">                System.out.println(rsmd.getColumnName(i+<span class="number">1</span>));</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">while</span>(rs.next())&#123;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">            ps.close();</span><br><span class="line">            con.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">add:新增分类</span><br><span class="line">list：资料列表</span><br><span class="line">topiclist：专题列表</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">topic_framework:专题框架</span><br><span class="line">catagory:资料分类</span><br></pre></td></tr></table></figure>

<h4 id="sendsms"><a href="#sendsms" class="headerlink" title="sendsms"></a>sendsms</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.aliyun.auth.credentials.Credential;</span><br><span class="line"><span class="keyword">import</span> com.aliyun.auth.credentials.provider.StaticCredentialProvider;</span><br><span class="line"><span class="keyword">import</span> com.aliyun.core.http.HttpClient;</span><br><span class="line"><span class="keyword">import</span> com.aliyun.core.http.HttpMethod;</span><br><span class="line"><span class="keyword">import</span> com.aliyun.core.http.ProxyOptions;</span><br><span class="line"><span class="keyword">import</span> com.aliyun.httpcomponent.httpclient.ApacheAsyncHttpClientBuilder;</span><br><span class="line"><span class="keyword">import</span> com.aliyun.sdk.service.dysmsapi20170525.models.*;</span><br><span class="line"><span class="keyword">import</span> com.aliyun.sdk.service.dysmsapi20170525.*;</span><br><span class="line"><span class="keyword">import</span> com.google.gson.Gson;</span><br><span class="line"><span class="keyword">import</span> darabonba.core.RequestConfiguration;</span><br><span class="line"><span class="keyword">import</span> darabonba.core.client.ClientOverrideConfiguration;</span><br><span class="line"><span class="keyword">import</span> darabonba.core.utils.CommonUtil;</span><br><span class="line"><span class="keyword">import</span> darabonba.core.TeaPair;</span><br><span class="line"></span><br><span class="line"><span class="comment">//import javax.net.ssl.KeyManager;</span></span><br><span class="line"><span class="comment">//import javax.net.ssl.X509TrustManager;</span></span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.CompletableFuture;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SendSms</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">send</span><span class="params">(String telephone)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">// HttpClient Configuration</span></span><br><span class="line">        <span class="comment">/*HttpClient httpClient = new ApacheAsyncHttpClientBuilder()</span></span><br><span class="line"><span class="comment">                .connectionTimeout(Duration.ofSeconds(10)) // Set the connection timeout time, the default is 10 seconds</span></span><br><span class="line"><span class="comment">                .responseTimeout(Duration.ofSeconds(10)) // Set the response timeout time, the default is 20 seconds</span></span><br><span class="line"><span class="comment">                .maxConnections(128) // Set the connection pool size</span></span><br><span class="line"><span class="comment">                .maxIdleTimeOut(Duration.ofSeconds(50)) // Set the connection pool timeout, the default is 30 seconds</span></span><br><span class="line"><span class="comment">                // Configure the proxy</span></span><br><span class="line"><span class="comment">                .proxy(new ProxyOptions(ProxyOptions.Type.HTTP, new InetSocketAddress(&quot;&lt;your-proxy-hostname&gt;&quot;, 9001))</span></span><br><span class="line"><span class="comment">                        .setCredentials(&quot;&lt;your-proxy-username&gt;&quot;, &quot;&lt;your-proxy-password&gt;&quot;))</span></span><br><span class="line"><span class="comment">                // If it is an https connection, you need to configure the certificate, or ignore the certificate(.ignoreSSL(true))</span></span><br><span class="line"><span class="comment">                .x509TrustManagers(new X509TrustManager[]&#123;&#125;)</span></span><br><span class="line"><span class="comment">                .keyManagers(new KeyManager[]&#123;&#125;)</span></span><br><span class="line"><span class="comment">                .ignoreSSL(false)</span></span><br><span class="line"><span class="comment">                .build();*/</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// Configure Credentials authentication information, including ak, secret, token</span></span><br><span class="line">        <span class="type">StaticCredentialProvider</span> <span class="variable">provider</span> <span class="operator">=</span> StaticCredentialProvider.create(Credential.builder()</span><br><span class="line">                <span class="comment">// Please ensure that the environment variables ALIBABA_CLOUD_ACCESS_KEY_ID and ALIBABA_CLOUD_ACCESS_KEY_SECRET are set.</span></span><br><span class="line">                .accessKeyId(<span class="string">&quot;LTAI5tAQeLTLWmaamBc5ymoF&quot;</span>)</span><br><span class="line">                .accessKeySecret(<span class="string">&quot;p2DqPOui7TWqoLw7oW8d5ije48LUdB&quot;</span>)</span><br><span class="line">                <span class="comment">//.securityToken(System.getenv(&quot;ALIBABA_CLOUD_SECURITY_TOKEN&quot;)) // use STS token</span></span><br><span class="line">                .build());</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Configure the Client</span></span><br><span class="line">        <span class="type">AsyncClient</span> <span class="variable">client</span> <span class="operator">=</span> AsyncClient.builder()</span><br><span class="line">                .region(<span class="string">&quot;cn-hangzhou&quot;</span>) <span class="comment">// Region ID</span></span><br><span class="line">                <span class="comment">//.httpClient(httpClient) // Use the configured HttpClient, otherwise use the default HttpClient (Apache HttpClient)</span></span><br><span class="line">                .credentialsProvider(provider)</span><br><span class="line">                <span class="comment">//.serviceConfiguration(Configuration.create()) // Service-level configuration</span></span><br><span class="line">                <span class="comment">// Client-level configuration rewrite, can set Endpoint, Http request parameters, etc.</span></span><br><span class="line">                .overrideConfiguration(</span><br><span class="line">                        ClientOverrideConfiguration.create()</span><br><span class="line">                                .setEndpointOverride(<span class="string">&quot;dysmsapi.aliyuncs.com&quot;</span>)</span><br><span class="line">                        <span class="comment">//.setConnectTimeout(Duration.ofSeconds(30))</span></span><br><span class="line">                )</span><br><span class="line">                .build();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">// Parameter settings for API request</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> Math.random()+<span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">yzm</span> <span class="operator">=</span> s.substring(s.length()-<span class="number">6</span>);</span><br><span class="line">        <span class="type">BaseDao</span> <span class="variable">bd</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BaseDao</span>();</span><br><span class="line">        bd.upd(<span class="string">&quot;insert into yzm_zz values(?,?)&quot;</span>,telephone,yzm);</span><br><span class="line">        <span class="type">SendSmsRequest</span> <span class="variable">sendSmsRequest</span> <span class="operator">=</span> SendSmsRequest.builder()</span><br><span class="line">                .phoneNumbers(telephone)</span><br><span class="line">                .signName(<span class="string">&quot;注册验证&quot;</span>)</span><br><span class="line">                .templateCode(<span class="string">&quot;SMS_21800103&quot;</span>)</span><br><span class="line">                .templateParam(<span class="string">&quot;&#123;\&quot;name\&quot;:\&quot;&quot;</span>+telephone</span><br><span class="line">                        +<span class="string">&quot;\&quot;,\&quot;code\&quot;:\&quot;&quot;</span>+yzm+<span class="string">&quot;\&quot;&#125;&quot;</span>)</span><br><span class="line">                <span class="comment">// Request-level configuration rewrite, can set Http request parameters, etc.</span></span><br><span class="line">                <span class="comment">// .requestConfiguration(RequestConfiguration.create().setHttpHeaders(new HttpHeaders()))</span></span><br><span class="line">                .build();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Asynchronously get the return value of the API request</span></span><br><span class="line">        CompletableFuture&lt;SendSmsResponse&gt; response = client.sendSms(sendSmsRequest);</span><br><span class="line">        <span class="comment">// Synchronously get the return value of the API request</span></span><br><span class="line">        <span class="type">SendSmsResponse</span> <span class="variable">resp</span> <span class="operator">=</span> response.get();</span><br><span class="line">        <span class="type">String</span> <span class="variable">str</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Gson</span>().toJson(resp);</span><br><span class="line">        <span class="comment">// Asynchronous processing of return values</span></span><br><span class="line">        <span class="comment">/*response.thenAccept(resp -&gt; &#123;</span></span><br><span class="line"><span class="comment">            System.out.println(new Gson().toJson(resp));</span></span><br><span class="line"><span class="comment">        &#125;).exceptionally(throwable -&gt; &#123; // Handling exceptions</span></span><br><span class="line"><span class="comment">            System.out.println(throwable.getMessage());</span></span><br><span class="line"><span class="comment">            return null;</span></span><br><span class="line"><span class="comment">        &#125;);*/</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// Finally, close the client</span></span><br><span class="line">        client.close();</span><br><span class="line">        <span class="keyword">return</span> str;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">此方法通常用于创建提供程序的实例，该实例可用于在向 AWS 服务发出请求时提供 AWS 凭证。</span><br><span class="line">StaticCredentialProvider provider = StaticCredentialProvider.create(&quot;ACCESS_KEY&quot;, &quot;SECRET_KEY&quot;);</span><br><span class="line">这将创建具有指定访问密钥和私有密钥的实例。然后，在向 AWS 服务发出请求时，可以使用此提供程序向 AWS 客户端提供凭证。</span><br></pre></td></tr></table></figure>

<h4 id="user"><a href="#user" class="headerlink" title="user"></a>user</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson2.JSON;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">import</span> java.util.UUID;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">jifenpaiming</span><span class="params">(Request req)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">BaseDao</span>().s(<span class="string">&quot;select telephone,score2 from user_zz &quot;</span> +</span><br><span class="line">                <span class="string">&quot;where score2&gt;0 order by score2 desc&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">visitcount</span><span class="params">(Request req)</span>&#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">token</span> <span class="operator">=</span> req.headers.get(<span class="string">&quot;token&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">count</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BaseDao</span>().so(<span class="string">&quot;select visit_count from user_zz where token=?&quot;</span>,token);</span><br><span class="line">        <span class="keyword">return</span> JSON.toJSONString(<span class="keyword">new</span> <span class="title class_">HashMap</span>()&#123;&#123;</span><br><span class="line">            put(<span class="string">&quot;result&quot;</span>,count);</span><br><span class="line">        &#125;&#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        System.out.println((UUID.randomUUID()+<span class="string">&quot;&quot;</span>+UUID.randomUUID()</span><br><span class="line">        +UUID.randomUUID()).replace(<span class="string">&quot;-&quot;</span>,<span class="string">&quot;&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">login</span><span class="params">(Request req)</span>&#123;</span><br><span class="line">        List&lt;Map&gt; list =  <span class="keyword">new</span> <span class="title class_">BaseDao</span>().smap(<span class="string">&quot;select 1 from user_zz where &quot;</span> +</span><br><span class="line">                <span class="string">&quot;telephone=? and password=?&quot;</span>,req.params.get(<span class="string">&quot;t&quot;</span>),</span><br><span class="line">                req.params.get(<span class="string">&quot;p&quot;</span>));</span><br><span class="line">        <span class="keyword">if</span>(list.size()&gt;=<span class="number">1</span>)&#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">token</span> <span class="operator">=</span> (UUID.randomUUID()+<span class="string">&quot;&quot;</span>+UUID.randomUUID()</span><br><span class="line">                    +UUID.randomUUID()).replace(<span class="string">&quot;-&quot;</span>,<span class="string">&quot;&quot;</span>);</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">BaseDao</span>().upd(<span class="string">&quot;update user_zz set token=? where telephone=?&quot;</span>,</span><br><span class="line">                    token,req.params.get(<span class="string">&quot;t&quot;</span>));</span><br><span class="line">            <span class="keyword">return</span> JSON.toJSONString(<span class="keyword">new</span> <span class="title class_">HashMap</span>()&#123;&#123;</span><br><span class="line">                put(<span class="string">&quot;result&quot;</span>,<span class="literal">true</span>);</span><br><span class="line">                put(<span class="string">&quot;token&quot;</span>,token);</span><br><span class="line">            &#125;&#125;);</span><br><span class="line"></span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> JSON.toJSONString(<span class="keyword">new</span> <span class="title class_">HashMap</span>()&#123;&#123;</span><br><span class="line">                put(<span class="string">&quot;result&quot;</span>,<span class="literal">false</span>);</span><br><span class="line">            &#125;&#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">list</span><span class="params">(Request req)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">BaseDao</span>().so(<span class="string">&quot;select score1+score2 as score from &quot;</span> +</span><br><span class="line">                <span class="string">&quot;user_zz where telephone=?&quot;</span>,req.params.get(<span class="string">&quot;t&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">reg</span><span class="params">(Request req)</span>&#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">phone</span> <span class="operator">=</span> req.params.get(<span class="string">&quot;phone&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">pwd</span> <span class="operator">=</span> req.params.get(<span class="string">&quot;pwd&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">BaseDao</span>()</span><br><span class="line">                .upd(<span class="string">&quot;insert into user_zz values(null,?,?)&quot;</span>,phone,pwd);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">sendmsg</span><span class="params">(Request req)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">phone</span> <span class="operator">=</span> req.params.get(<span class="string">&quot;phone&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> SendSms.send(phone);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">checkcode</span><span class="params">(Request req)</span>&#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">phone</span> <span class="operator">=</span> req.params.get(<span class="string">&quot;phone&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">code</span> <span class="operator">=</span> req.params.get(<span class="string">&quot;code&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">dbCode</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BaseDao</span>()</span><br><span class="line">                .so(<span class="string">&quot;select yzm from yzm_zz where telephone=?&quot;</span>,phone);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> JSON.toJSONString(<span class="keyword">new</span> <span class="title class_">HashMap</span>()&#123;&#123;</span><br><span class="line">            put(<span class="string">&quot;result&quot;</span>, code.equals(dbCode));</span><br><span class="line">        &#125;&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">jifenpaiming:积分排名</span><br><span class="line">visitcount:用户访问次数(微信小程序)</span><br><span class="line">login:用户登录</span><br><span class="line">list:查看用户总积分</span><br><span class="line">reg:登录注册-登录档-用户电话号和密码</span><br><span class="line">sendmsg:验证码</span><br><span class="line">checkcode:校验码</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">【UUID.randomUUID()+&quot;&quot;+UUID.randomUUID()</span><br><span class="line">        +UUID.randomUUID()】：</span><br><span class="line">UUID.randomUUID（） 是 Java 中的一种方法，用于为对象生成唯一标识符。“+”是一个字符串连接运算符，用于将两个字符串连接在一起。</span><br><span class="line">因此，当您编写 UUID.randomUUID（） + “” 时，这意味着生成的唯一标识符将被转换为字符串并与空字符串连接，从而产生唯一标识符的字符串表示形式。</span><br><span class="line">如果您在此之后继续添加 UUID.randomUUID（），这意味着您将生成多个唯一标识符并将所有这些标识符连接成一个字符串。</span><br><span class="line"></span><br><span class="line">此代码创建一个新的 HashMap 对象，并将键值对 “result” ： true 或 false 取决于变量 “code” 是否等于变量 “dbCode”。</span><br><span class="line">put(&quot;result&quot;, code.equals(dbCode));</span><br></pre></td></tr></table></figure>

<p><strong>Corresponding Table</strong></p>
<img src="../t_代码报错与分析/data/image-20230717173713295.png" alt="image-20230717173713295" style="zoom:67%;" />

<p>添加token唯一索引</p>
<img src="../t_代码报错与分析/data/image-20230717173833977.png" alt="image-20230717173833977" style="zoom:67%;" />

<p><img src="/../t_%E4%BB%A3%E7%A0%81%E6%8A%A5%E9%94%99%E4%B8%8E%E5%88%86%E6%9E%90/data/image-20230717173908205.png" alt="image-20230717173908205"></p>
<h3 id="前端"><a href="#前端" class="headerlink" title="前端"></a>前端</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">ajax.js:对get和post的函数定义</span><br><span class="line"></span><br><span class="line">placeholder 在 textarea 元素值为空时，显示一个简短的提示，</span><br><span class="line">并在 textarea 元素获得焦点时消失。</span><br><span class="line"></span><br><span class="line">//根据token值判断用户是否登陆</span><br><span class="line">if(!localStorage.token)&#123;</span><br><span class="line">   location = &quot;login.html&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> //address_list由java类拼接</span><br><span class="line"> get(&quot;address_list&quot;, (res) =&gt; &#123;...&#125;)：</span><br><span class="line">该语句使用axios库向服务端地址发送GET请求，请求的API路径是“address_list”。</span><br><span class="line">如果请求成功，服务器会返回相应的数据并执行该语句中的回调函数。</span><br><span class="line">回调函数中的参数res表示服务器返回的数据。</span><br><span class="line"></span><br><span class="line">tocnt:查看文章内容</span><br><span class="line">topay:支付函数；订单号</span><br><span class="line"></span><br><span class="line">利用本地存储记录当前文章内容，点击链接</span><br><span class="line">localStorage.currentArticle = JSON.stringify(datas[i]);</span><br><span class="line">跳转链接</span><br><span class="line">location = &quot;cnt.html&quot;;</span><br><span class="line"></span><br><span class="line">&lt;!--它能够将另一个 HTML 页面嵌入到当前页面中。src表示被嵌套的页面的 URL 地址。--&gt;</span><br><span class="line">&lt;!--alipay_code支付码改变--&gt;</span><br><span class="line">&lt;iframe&gt;&lt;/iframe&gt;</span><br><span class="line"></span><br><span class="line">src一张支付图片</span><br><span class="line"> document.getElementsByTagName(&quot;iframe&quot;)[0].src = &quot;http://localhost:8084/article_pay?title=积分购买&amp;price=&quot;+</span><br><span class="line">                this.getAttribute(&quot;money&quot;);</span><br><span class="line"></span><br><span class="line">查看支付情况（用定时器查）</span><br><span class="line">var timer = setInterval(f,3000);</span><br><span class="line">clearInterval(timer)     //清除定时请求</span><br><span class="line"></span><br><span class="line">getElementsByTagName() 方法可返回带有指定标签名的对象的集合。</span><br><span class="line"></span><br><span class="line">var inputs = document.getElementsByTagName(&quot;input&quot;); //获得input中的标签名</span><br><span class="line"></span><br><span class="line">当前被触发的事件</span><br><span class="line">inputs[i].onclick = function()&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;input type=&quot;radio&quot; money=&quot;18&quot; value=&quot;1&quot; name=&quot;taocan&quot; /&gt;</span><br><span class="line">radio 类型的 &lt;input&gt; 元素通常用于一个单选组中，其中包含一组描述一系列相关选项的单选按钮。单选按钮通常渲染为小圆圈，当选中该选项时，圆圈被填充或高亮。</span><br><span class="line"></span><br><span class="line">定时查看积分情况</span><br><span class="line">timer = setInterval(f,500);</span><br><span class="line"></span><br><span class="line">currentArticle = (res[0]);//当前文章</span><br><span class="line"></span><br><span class="line">查看更多之后消失</span><br><span class="line">hidebox.style.display = &quot;none&quot;;</span><br><span class="line">morebtn.style.display = &quot;none&quot;;</span><br></pre></td></tr></table></figure>

<p><strong>right:(表)</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line">&lt;!<span class="variable constant_">DOCTYPE</span> html&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>ECharts<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="comment">&lt;!-- 引入刚刚下载的 ECharts 文件 --&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;js/echarts.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;js/ajax.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="comment">&lt;!-- 为 ECharts 准备一个定义了宽高的 DOM --&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;main&quot;</span> <span class="attr">style</span>=<span class="string">&quot;float:left;width: 50%;height:300px;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;main2&quot;</span> <span class="attr">style</span>=<span class="string">&quot;float:left;width: 50%;height:300px;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;main3&quot;</span> <span class="attr">style</span>=<span class="string">&quot;float:left;width: 50%;height:300px;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;main4&quot;</span> <span class="attr">style</span>=<span class="string">&quot;float:left;width: 50%;height:300px;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">     <span class="comment">//x,y     </span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">//loadData([&quot;a&quot;,&quot;b&quot;],[30,27])</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">get</span>(<span class="string">&quot;user_pointrank&quot;</span>,<span class="function">(<span class="params">res</span>)=&gt;</span>&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">var</span> mydata = [];</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">var</span> xdata = [];</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">var</span> ydata = [];</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;res.<span class="property">length</span>;i++)&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">       mydata.<span class="title function_">push</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">         <span class="attr">name</span>:res[i].<span class="property">telephone</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">         <span class="attr">value</span>:res[i].<span class="property">score2</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">       &#125;)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        xdata.<span class="title function_">push</span>(res[i].<span class="property">telephone</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">       ydata.<span class="title function_">push</span>(res[i].<span class="property">score2</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="title function_">loadData</span>(mydata,<span class="string">&quot;main&quot;</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="title function_">loadData2</span>(xdata,ydata,<span class="string">&quot;main2&quot;</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="title function_">loadData2</span>(xdata,ydata,<span class="string">&quot;main3&quot;</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="title function_">loadData</span>(mydata,<span class="string">&quot;main4&quot;</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">function</span> <span class="title function_">loadData</span>(<span class="params">mydata,idstr</span>)&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="comment">// 基于准备好的dom，初始化echarts实例</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">var</span> myChart = echarts.<span class="title function_">init</span>(</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">              <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(idstr));</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// 指定图表的配置项和数据</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">var</span> option = &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">title</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="attr">text</span>: <span class="string">&#x27;政考之道用户积分分布&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="attr">subtext</span>: <span class="string">&#x27;202307&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="attr">left</span>: <span class="string">&#x27;center&#x27;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">tooltip</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="attr">trigger</span>: <span class="string">&#x27;item&#x27;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">legend</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="attr">orient</span>: <span class="string">&#x27;vertical&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="attr">left</span>: <span class="string">&#x27;left&#x27;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">series</span>: [</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="attr">name</span>: <span class="string">&#x27;积分&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="attr">type</span>: <span class="string">&#x27;pie&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="attr">radius</span>: <span class="string">&#x27;50%&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="attr">data</span>: mydata,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="attr">emphasis</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">              <span class="attr">itemStyle</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                <span class="attr">shadowBlur</span>: <span class="number">10</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                <span class="attr">shadowOffsetX</span>: <span class="number">0</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                <span class="attr">shadowColor</span>: <span class="string">&#x27;rgba(0, 0, 0, 0.5)&#x27;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">              &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        ]</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// 使用刚指定的配置项和数据显示图表。</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      myChart.<span class="title function_">setOption</span>(option);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">function</span> <span class="title function_">loadData2</span>(<span class="params">xdata,ydata,idstr</span>)&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="comment">// 基于准备好的dom，初始化echarts实例</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">var</span> myChart = echarts.<span class="title function_">init</span>(</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">              <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(idstr));</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// 指定图表的配置项和数据</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">var</span> option = &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">xAxis</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="attr">type</span>: <span class="string">&#x27;category&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="attr">data</span>: xdata</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">yAxis</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="attr">type</span>: <span class="string">&#x27;value&#x27;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">series</span>: [</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="attr">data</span>: ydata,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="attr">type</span>: <span class="string">&#x27;line&#x27;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        ]</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// 使用刚指定的配置项和数据显示图表。</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      myChart.<span class="title function_">setOption</span>(option);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<p>单个表：<img src="../t_代码报错与分析/data/image-20230718231024902.png" alt="image-20230718231024902" style="zoom:50%;" /></p>
 
      <!-- reward -->
      
      <div id="reword-out">
        <div id="reward-btn">
          Donate
        </div>
      </div>
      
    </div>
    

    <!-- copyright -->
    
    <div class="declare">
      <ul class="post-copyright">
        <li>
          <i class="ri-copyright-line"></i>
          <strong>Copyright： </strong>
          
          Copyright is owned by the author. For commercial reprints, please contact the author for authorization. For non-commercial reprints, please indicate the source.
          
        </li>
      </ul>
    </div>
    
    <footer class="article-footer">
       
<div class="share-btn">
      <span class="share-sns share-outer">
        <i class="ri-share-forward-line"></i>
        分享
      </span>
      <div class="share-wrap">
        <i class="arrow"></i>
        <div class="share-icons">
          
          <a class="weibo share-sns" href="javascript:;" data-type="weibo">
            <i class="ri-weibo-fill"></i>
          </a>
          <a class="weixin share-sns wxFab" href="javascript:;" data-type="weixin">
            <i class="ri-wechat-fill"></i>
          </a>
          <a class="qq share-sns" href="javascript:;" data-type="qq">
            <i class="ri-qq-fill"></i>
          </a>
          <a class="douban share-sns" href="javascript:;" data-type="douban">
            <i class="ri-douban-line"></i>
          </a>
          <!-- <a class="qzone share-sns" href="javascript:;" data-type="qzone">
            <i class="icon icon-qzone"></i>
          </a> -->
          
          <a class="facebook share-sns" href="javascript:;" data-type="facebook">
            <i class="ri-facebook-circle-fill"></i>
          </a>
          <a class="twitter share-sns" href="javascript:;" data-type="twitter">
            <i class="ri-twitter-fill"></i>
          </a>
          <a class="google share-sns" href="javascript:;" data-type="google">
            <i class="ri-google-fill"></i>
          </a>
        </div>
      </div>
</div>

<div class="wx-share-modal">
    <a class="modal-close" href="javascript:;"><i class="ri-close-circle-line"></i></a>
    <p>扫一扫，分享到微信</p>
    <div class="wx-qrcode">
      <img src="//api.qrserver.com/v1/create-qr-code/?size=150x150&data=http://example.com/2023/07/23/%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90/" alt="微信分享二维码">
    </div>
</div>

<div id="share-mask"></div>  
    </footer>
  </div>

   
  <nav class="article-nav">
    
    
      <a href="/2023/07/23/%E6%88%91%E7%9A%84%E7%AC%AC%E4%B8%80%E7%AF%87%E5%8D%9A%E5%AE%A2%E6%96%87%E7%AB%A0/" class="article-nav-link">
        <strong class="article-nav-caption">下一篇</strong>
        <div class="article-nav-title">我的第一篇博客文章</div>
      </a>
    
  </nav>

  
   
  
   
    <script src="https://cdn.staticfile.org/twikoo/1.4.18/twikoo.all.min.js"></script>
    <div id="twikoo" class="twikoo"></div>
    <script>
        twikoo.init({
            envId: ""
        })
    </script>
 
</article>

</section>
      <footer class="footer">
  <div class="outer">
    <ul>
      <li>
        Copyrights &copy;
        2015-2023
        <i class="ri-heart-fill heart_icon"></i> John Doe
      </li>
    </ul>
    <ul>
      <li>
        
      </li>
    </ul>
    <ul>
      <li>
        
        
        <span>
  <span><i class="ri-user-3-fill"></i>Visitors:<span id="busuanzi_value_site_uv"></span></span>
  <span class="division">|</span>
  <span><i class="ri-eye-fill"></i>Views:<span id="busuanzi_value_page_pv"></span></span>
</span>
        
      </li>
    </ul>
    <ul>
      
    </ul>
    <ul>
      
    </ul>
    <ul>
      <li>
        <!-- cnzz统计 -->
        
        <script type="text/javascript" src='https://s9.cnzz.com/z_stat.php?id=1278069914&amp;web_id=1278069914'></script>
        
      </li>
    </ul>
  </div>
</footer>    
    </main>
    <div class="float_btns">
      <div class="totop" id="totop">
  <i class="ri-arrow-up-line"></i>
</div>

<div class="todark" id="todark">
  <i class="ri-moon-line"></i>
</div>

    </div>
    <aside class="sidebar on">
      <button class="navbar-toggle"></button>
<nav class="navbar">
  
  <div class="logo">
    <a href="/"><img src="/images/ayer-side.svg" alt="王晋"></a>
  </div>
  
  <ul class="nav nav-main">
    
    <li class="nav-item">
      <a class="nav-item-link" href="/">主页</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/archives">归档</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/categories">分类</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/tags">标签</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/tags/%E6%97%85%E8%A1%8C/">旅行</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" target="_blank" rel="noopener" href="http://shenyu-vip.lofter.com">摄影</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/friends">友链</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/2019/about">关于我</a>
    </li>
    
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      
      <a class="nav-item-link nav-item-search"  title="Search">
        <i class="ri-search-line"></i>
      </a>
      
      
      <a class="nav-item-link" target="_blank" href="/atom.xml" title="RSS Feed">
        <i class="ri-rss-line"></i>
      </a>
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
    </aside>
    <div id="mask"></div>

<!-- #reward -->
<div id="reward">
  <span class="close"><i class="ri-close-line"></i></span>
  <p class="reward-p"><i class="ri-cup-line"></i>请我喝杯咖啡吧~</p>
  <div class="reward-box">
    
    <div class="reward-item">
      <img class="reward-img" src="/images/alipay.jpg">
      <span class="reward-type">支付宝</span>
    </div>
    
    
    <div class="reward-item">
      <img class="reward-img" src="/images/wechat.jpg">
      <span class="reward-type">微信</span>
    </div>
    
  </div>
</div>
    
<script src="/js/jquery-3.6.0.min.js"></script>
 
<script src="/js/lazyload.min.js"></script>

<!-- Tocbot -->
 
<script src="/js/tocbot.min.js"></script>

<script>
  tocbot.init({
    tocSelector: ".tocbot",
    contentSelector: ".article-entry",
    headingSelector: "h1, h2, h3, h4, h5, h6",
    hasInnerContainers: true,
    scrollSmooth: true,
    scrollContainer: "main",
    positionFixedSelector: ".tocbot",
    positionFixedClass: "is-position-fixed",
    fixedSidebarOffset: "auto",
  });
</script>

<script src="https://cdn.staticfile.org/jquery-modal/0.9.2/jquery.modal.min.js"></script>
<link
  rel="stylesheet"
  href="https://cdn.staticfile.org/jquery-modal/0.9.2/jquery.modal.min.css"
/>
<script src="https://cdn.staticfile.org/justifiedGallery/3.8.1/js/jquery.justifiedGallery.min.js"></script>

<script src="/dist/main.js"></script>

<!-- ImageViewer -->
 <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>

<link rel="stylesheet" href="https://cdn.staticfile.org/photoswipe/4.1.3/photoswipe.min.css">
<link rel="stylesheet" href="https://cdn.staticfile.org/photoswipe/4.1.3/default-skin/default-skin.min.css">
<script src="https://cdn.staticfile.org/photoswipe/4.1.3/photoswipe.min.js"></script>
<script src="https://cdn.staticfile.org/photoswipe/4.1.3/photoswipe-ui-default.min.js"></script>

<script>
    function viewer_init() {
        let pswpElement = document.querySelectorAll('.pswp')[0];
        let $imgArr = document.querySelectorAll(('.article-entry img:not(.reward-img)'))

        $imgArr.forEach(($em, i) => {
            $em.onclick = () => {
                // slider展开状态
                // todo: 这样不好，后面改成状态
                if (document.querySelector('.left-col.show')) return
                let items = []
                $imgArr.forEach(($em2, i2) => {
                    let img = $em2.getAttribute('data-idx', i2)
                    let src = $em2.getAttribute('data-target') || $em2.getAttribute('src')
                    let title = $em2.getAttribute('alt')
                    // 获得原图尺寸
                    const image = new Image()
                    image.src = src
                    items.push({
                        src: src,
                        w: image.width || $em2.width,
                        h: image.height || $em2.height,
                        title: title
                    })
                })
                var gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, {
                    index: parseInt(i)
                });
                gallery.init()
            }
        })
    }
    viewer_init()
</script> 
<!-- MathJax -->

<!-- Katex -->

<!-- busuanzi  -->
 
<script src="/js/busuanzi-2.3.pure.min.js"></script>
 
<!-- ClickLove -->

<!-- ClickBoom1 -->

<!-- ClickBoom2 -->

<!-- CodeCopy -->
 
<link rel="stylesheet" href="/css/clipboard.css">
 <script src="https://cdn.staticfile.org/clipboard.js/2.0.10/clipboard.min.js"></script>
<script>
  function wait(callback, seconds) {
    var timelag = null;
    timelag = window.setTimeout(callback, seconds);
  }
  !function (e, t, a) {
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '<i class="ri-file-copy-2-line"></i><span>COPY</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      $(".article pre code").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        let $btn = $(e.trigger);
        $btn.addClass('copied');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-checkbox-circle-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPIED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-checkbox-circle-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
      clipboard.on('error', function(e) {
        e.clearSelection();
        let $btn = $(e.trigger);
        $btn.addClass('copy-failed');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-time-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPY FAILED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-time-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
    }
    initCopyCode();
  }(window, document);
</script>
 
<!-- CanvasBackground -->

<script>
  if (window.mermaid) {
    mermaid.initialize({ theme: "forest" });
  }
</script>


    
    

  </div>
</body>

</html>